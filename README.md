# Thiqah_assesment

Hello reader,,,

This is the source code for Thiqah assessment, it's a small mock system for creating orders, it contains two services, Orders service, and Users service, which communicate with each other only through a message broker, and are completely decoupled,

All the database and message broker connections are already setup, you can just runt and test directly with no setup, I've used a free tiers services for message broker (RabbitMQ) and for the database (Postgres) so you may find the system slow, and unstable, however this is acceptable only for test purposes.

The connection strings are saved in the appsettings files for each service, and the rabbitMQ connection is hardcoded in the library,,,

Both services have an exception handler with a unified exception response, containing a lot of debugging details.

This assessment is done in a very short time, and with no prior notice, so we might expect some non best practices implemented here and there.

# The Users service

This service was implemented with clean architecture design and DDD, and it has implemented the repository pattern and CQS principles,

It has three APIs, One for Getting user info, One for listing users, and one for creating a new user, all APIs are documented in a swagger document (service base url/swagger)

It has two background event listeners, one is the GetUserEventHandler, which will response for the requester with a User details in a (request/response) pattern, and one is the UserCreatedOrderEventHandler which will allow it to increment the users orders count in a (pub/sub) pattern..

# The Orders service

This service was also implemented with clean architecture, DDD, repo pattern, and CQRS
Why CQRS: just to show the different implementations that we can implement the service with.

It also has three APIs, one for getting an order, one for listing orders, and one for creating a new order, it has no Event handlers.

# Architecture documents

I've prepared some different types of architecture documentations for discussion for the assessment.

1- High level component architecture using the C$ model can be found [here](https://app.diagrams.net/?tags=%7B%7D&title=thiqah_diagrams.drawio#R7VrJcts4EP0aHZ3iImo5aksyVXbiijyV5AiRMMmEJBgQ2ubrp7FxhTbbydg1UiVl4RFoNJqN95oQe%2B4s3X2gKI%2FuSICTnmMFu5477zmObbkj%2BMORvUQ8byCBkMaB6lQBy%2FgfrEcqdB0HuGh0ZIQkLM6boE%2ByDPusgSFKybbZ7ZEkzVlzFOIOsPRR0kW%2FxgGLJDryrAr%2FiOMw0jPblrqSIt1ZAUWEArKtQe6i584oIUx%2BS3cznPDg6bjIce8PXC0dozhjhgFk9YPHA3okyMcRrBvTVsj6n1CqlvmZisvg5b5gONUdHva56rAU%2BNInOZ6SdRYgutedJnmexD5iMclk34co%2FoUieTlBK8gIAfecQQKeTh9Jxv0q2F4FefBrTfSFm0KkwAQ62IN8V12Eb6H6K6ys2kAQb4xWGd6xG5TEYSbNJviRmcx6Kh6Opy1CLIXR5jyAduYGTK7qRV3ypFf1%2BIJz3vyQf04tPSYPYYQed5ubr25m%2F3U33EZf0I1bpl2ZTpVzDuX3FfPxtroZajvavL2NYoaXOeQSIFvY7IBFLE1U9wAVUTkWUV8NhZwEU3GSzEhCqJjHXdhzbzEEvGCU%2FMS1KwPxUZPXcPkBXGTTFPk%2FQ%2BGs7pKRDPNpZUTnIpzudIMpg7glEwWvCGMkLa0QnvItCwWsL87CBwKrm1sVwNdlqVXeI8Yw5QaB2qw%2BoClmaBHETK2eEoYYWomw8kE5pjF0wXweCnsSZWGC7ytwmpFbtUss7d09CgI5ryUWlpDtRLMZRxTd1WbBuxxlgWrANGtaxBv8Bcv9JLuAj2oE9zMncQYOLDZAINouWhUkWTM8Ke9g2VOQh8ez0nrH98jMEv95Os4EaMKGXdDmLW2hCZqwoWcyaRvmbmOOATSaNMxttZyEf3qH8bTCWt%2B6JGzX9tgHTOAec6a01IC%2BEoO9VjnV3lbaMhwoLKrpSl%2BrCFIcHpamK8qHL2pf66YSgScIAsRgqaTAmsFuBMYSwbFOKgXvjeIMU6NYzHHh0zivxOIjLFJQ4EZUDj5Jc9iLPN2gaIhRSFF6VZKXcKke%2BcOendQQ76iGiDxpCEOT5BXP1hXhPPJmnJKNIlTJltXl4i5zUs6INRZss3WXWQ%2BQaZ1vTVR6Jc2XIs1RkzS9Lmc6Rs78w5TJ6xIMKXEhI3bK59JOgwyvFPjKiunhqyimZ%2FOJM11ci%2BlrMf2%2F1wW73xWGwcggDK71bGXoHMcYKYKbc5q8gIMQL1WTUBaRkGQoWVRoq56p%2BtwSsZF4Cv3AjO1VSqE1I032wLuYfePD4TbI1vfalfmuzHFo7GuN2i6SWAYhkYYcT7e%2F1y9WtkRLG6uz3ahLQO%2FFp0wBHpHjCQABJGvq4yORVqeMDNEQsyP97JE5oyhOQBM2TUcuSI%2FLKoW%2FC%2FUIhekmhnUZKgYl%2FOUl7EcZhDBUuf7uE2aiQKCY7zHHuicFC6G2lS1gqnJo94kLqC3hfOhYa%2BUIlCVUaCJvIFl7IBBIa4V5jqd5glPwRg6CjIt4Q6von6pMjDXFRdVDsxQQ4eaZzb2QSBXlo7WBco0em%2BTSKNjmKBx7cDOt8%2BIypr4hTpUxJ8qW4wVFq3DpW8PJeNZlh0fxqRUgPs6ksleF0MBU7zjWaDAbGyqI2gPf9bnsJfXXdlsCPDA8mfUNAmw%2F%2FzTrTAHW%2BvHWBXj42gV4%2FKYEuDrE%2FK8VmGhPfIqVnioBrmvyVWLfssSOrxJ7ldgn%2Fl40fu0Sayvm36BkrX87amsuT9b8YDSaxy%2B98oWJ86PkDJtRcg0nAa5tiNLg8iCdGZXh6agUERJq4%2B9BC0AF3NPbfyW54nZVAiUVfF4zMKMPmdRBle0dYQVxtCY1aWydm65HcuBwneh4jdtzUwL1kxrTQY392%2B7PyHB%2FmnKiX0XSgmHXtQOSVge0AnVhdUxpz5CpEciUGNOycoeLgr%2BtBE%2FlnJfpRRLdyr3n%2F05Xakb7ZDiNg0DU0ad%2FrPttGecYWNKUYE%2FY%2F9Cs3tkS12pvvrmLfwE%3D)

2- Technology stack diagram [here](https://app.diagrams.net/?tags=%7B%7D&title=thiqah_diagrams.drawio#R3VjPl5owEP5rOG4fCYL2uLraHmrb7bav5wgRUgOxIQr2r%2B9EAghZ32sPrgoXki8zk8k3PzQ43iwtP0iyTZYiotzBblQ63pODMXK9Cbw0cqgQ3w8qIJYsMkIt8ML%2B0FrToDsW0bwjqITgim27YCiyjIaqgxEpRdEVWwve3XVLYmoBLyHhNvqTRSqp0InvtvhHyuKk3hm5ZiUltbAB8oREojiBvLnjzaQQqhql5YxyTV7NS6W3OLPaOCZppv5F4ZNb%2FkLZ82Ye7OR6f1iJUSEejJU94TtzYAcHHOxN1wLMgtd1RILfO%2B3pFLVDGMXmfVRZ9YHahjrwrhG98FCZfgQB7G%2FLSq2xDAHlQnaUHOy5x8f24DsNkwwU4sNxOxJudMoxEkuS1s4AM5U%2FXR8Btvy2RHHnFFjRUuOJSjkACIa5kmJDZ8bnTGRUn5Jx3oMIZ3EG0xCCRgGf7qlUDNLt0SykLIr0NtMiYYq%2BbEmo9yyguACTYpdFVMfTNSSagkETM581rHmL49O4rzei5dncQU1GQilTkVIlNZdGYWRy%2BNCdFm1FjAODJSfVUMsRU4RxY7jNUxiYVP2PtMVW2v7Iqcx1lKjcM%2BCsH7KWOnSG3JNonjCLfZtZk4XdAAP%2BNJqjhX8RxhG2KcfuK5QHl6Lcsyh%2F95mqY6HK%2B6d73KN7YtONRm%2BZ4SOL7q8iV7GE38KBcY1fSe235do%2Fl9rwV8UFk97gKA%2BuTfnYovyLjIbVwT18ay18MugW7vm31sPfD7eH98m%2BfhOvL4wD7uIW6Vdv48i%2BPy5pnus7NXZX%2Bkok7571AN1aH0f29ecbWa2YTvbl8%2F0T3r%2F7XLCRw7T9AnNcO%2FmO5c3%2FAg%3D%3D)

3- Create order flow diagram [hrer](https://app.diagrams.net/?title=thiqah_diagrams.drawio#R3Vpfc9o4EP80PMJY%2Fgd5TEi4m5s0zQxzc5enjrCFrauwqCwC9NPfypaxhUzqpKYk5SG2VtJK2t3f7mqdgTdd7f4QeJ1%2B4jFhA9eJdwPvduC6yPEm8FCUfUkJgrAkJILGelBNmNPvpJqpqRsak9wYKDlnkq5NYsSzjETSoGEh%2BNYctuTMXHWNE2IR5hFmNvUfGsu0pE4Cp6b%2FSWiSVisjR%2FescDVYE%2FIUx3zbIHl3A28qOJfl22o3JUwJr5JLOW92ovewMUEy2WXCw32Q39P5MPPH2%2BFf1w%2BfptvhUHN5xmyjDzxwQwb8bpYc2MKuK42E3zZqpzeofoW3RD%2BLKYtjQsVD7pnJRHUMS9bXMMAN1rty2oEzKJRxYUwauJ5T%2FOwdTAXBksAsLmIilJ4ZiBqsjuJE4NVhg%2BJ4hyCucpMW2TqMNdQ1juZKslP0VK4YEBC85lLwr2SqD5LxjKijU8aOSJjRJINmBJqE3Xs3z0RICjZ4rTtWNI7VMjfblEoyX%2BNIrbkFxAFN8E0WE6VkR0tWowhNdHt6EKU3K36H7auFyO6kQaGDmQK%2BCV8RKfYwRE%2BoMLA3m9saJuNQ09IGRHxNwxqZyYFxbbzwou33FbbsWyohMWBZN7mQKU94htldTT0SXj3mnvO11uJ%2FRMq9FineSG7qmOyo%2FFdNHwW69dToud1pzkVj32g8EkHh2ErdJS0DETQYqeZTs69mVbT2tr7dwNa3BkylbyWQl7UN8uMbEZEX5OxqN4xFQuQL47x26xGEYUmfzX30bgyu5dj%2BzgvPEClXQbOkdhZHRlOitnL27hGkU7xW41a7RMW7kfIzUYqFHOUgD%2FnFPQHSrmpqegeg3%2Fp3aBb0A1fPQwZekWsDFnlXNmCRdy7EosmHgewb4Vm0jrF%2BAcx6HTEbXhKznoVZK66vBY9InltmUxsFOoHAhgHgRc7ZRpJrEVWhUlHrln8I3k038EYMT6f9hVzP9wwMu5MWDKOgBcPOuTB8WQg3AFzDuXvUvQASw45IHF8SiVcWEh8%2Bt%2Br5Hi%2Fgwmeiq3M2KwhcAfCi4KekvOY0k8VRgptBcPtq%2FbRAS18L9SL1ZaypudNmfRKHQ2eEHBQaWKxSjs4a0twf1akbQ%2FhymYNlHKvwsImfCLfuhwm3PWbI7yUEdwU%2BOhECfg3ykR2En4gdb39r7Jc4OQl%2BZ%2BT6ZhR%2B78AP7cQqJdFXNW0Jf%2FTNCECXS1vVb7wPxSSiOeVZvxeiXpMp10ym%2FLYLUdCWTIXnSqbGlqKq6lNMn6vK0wxTBg65Lks1%2BlqGa%2B1mXBb1T%2FDmL5bDDGb9mAK4ghXNsFRK7NMYZjMPfv0Yw5VZzDrUn5u2MGmpZl2d7W4cfORgfYH4iqrPAz8MsP5FA6xdcp8DMpqXXFCK68QYIhfOSW%2F%2BmAoIhl8U2%2FfskpXhNYEYhi1AbCsrT84GxPElgYgGP3fDrbNmI2euU%2Bh3njUjvyuqL1q6qrb5cuR%2B3CwYzdOBSjS6hmCLCXkmxVeoTgFbuwNZPH5UF7M9i%2F76B7fdq%2FfiIMycbdxWAGvL2c4Xp%2B3kukVpn7VrL74%2BvCJ5yzeRqncuN4ztf5e0rU97CCZm3ha25PCu0xIu3lIQhWb9ub68m9X%2F9ODd%2FQ8%3D)

4- Create order sequence diagram [here](https://app.diagrams.net/?title=thiqah_diagrams.drawio#R7Vxbd5s4EP41fkwPF4PxY%2Bq02T3bnGQ37Um7bzLImA1GjhC%2B5NevBBIGCceEBJza%2BCUwSIM0830aaSQyMCeLzTUGy%2FkN8mA4MDRvMzCvBoaha6ZD%2FzDJNpNYlp0JfBx4vNBOcB88Q1GTS5PAg3GpIEEoJMGyLHRRFEGXlGQAY7QuF5uhsPzWJfChIrh3QahKHwKPzDOpY2k7%2BR8w8OfizbrGnyyAKMwF8Rx4aF0QmV8G5gQjRLKrxWYCQ2Y8YZes3tc9T%2FOGYRiROhUenv75V9%2F%2BZ%2BvX3xfPP%2Fy1vQ3NC65lBcKEd3hg2CHV99kLVvTSZ5dCNMWyhL6tolyFaIZoI6kNyJYb1n5KkHhwEaduv6QF9PFyk1Xjz4WiHzHEhbdm%2Bl5ujFF6oUHtv2SXwCUI0wLreUDg%2FRK4TLim6KWyOVmE9E7nDeNwNCx%2BP0Ehq0q1mVr6Y%2FIgDAvyr%2Bkvf%2F8KYgI3ez2m5zigBIJoAQne0iK8gsORw6mjC9CtC0DkonkBgyMuAxz6fq54hw56wQHyCrAYClhusQdxzOwM8SqglpSNTrVSpsLD5gbxMqPvLNhAr2x%2FfXwc%2Bxtjs5EDnLYcYCoOYLQ4Wftb2uhj2X%2Bo2P8GxjGLIIY2xeiRDVGn5ICR0WwEeg8HwM1fT7%2BG8c318%2BT7I3hA%2FnR290K4EgFGTCBE%2FNDVUJKHs6ZByrCUIEXnH8IDO6HwkdKC%2B8R1KXBmCeuwiyEgDEGIDaYpl58SGDEya14AfAwWLwbgPaFQ6Z1SVEIqhQkpQzImDNMCWxGKoAQ3LgJh4Ef01qWwgiy0MtAFdA51yR8sAs8L93EAoyTyGOKvNAn1jor69x1eSuCuwPbIrgD3sC1wq%2BFVHU0i75JNapmxQxDHgVv22H5bvjSCwE1AfrI6nyx%2B94vrY9dXG64uvdnym6xp0FNmz5L1afNRgl14aA6qeqngB6vCDUKGYQhIsCo3o8o3%2FA13KEhZvhHeLKPAlN2bNZ%2FXKk6vJUW6NFY6Y0kRAdiHRFGUQiXvdnP0qHOD80CPcUz0mKZBe110uzI81MWPqmqsd4sgdXZzAgg6FjIsKbrQ7jbDhaxorHWLCqtHxfuhYmSN5fGiKS5UVV0jwz4WMj66l%2BWpgLIeqh8TDihq2cMjxcMTabEi%2B5v65BuYwlBa29ZeIGBIl1lgmupjrl6yrqWdtT4PrKtXg6RigcAzxfwlgzw%2FW4TPfrzvXU1caJ9Mbei8DUCiCJrNYtiKS52etHvnXyWumfJoWntgtg8oapm0Y8XD1wxKWhKfG2GdUyCsWAT0jFWJJi3d32uKrShqmbG6mtbMKJttemkeIOC8mKtr1cD6zahr9NStx7ihNm4abA8oapu61VtyOWmpoeIliuKKnbmT5q%2FRPn%2FFJu2oXKNFOh8tQfbR6aywcNiQzvKCV1HUNp3VbFdPZ4H8Tuh8YUlVWuSzmsDKz7NUTrnECSJ3GwaUxdjcs6NZ8P804%2Fu3aS4A7qOfjgK3CaFqIJfzjWvdeoWjW9z5H9bY%2Ba%2FaHG1v51%2FNRYmzL%2BfuK8f%2BaL46WpLpFPcMhu%2B1k0SD6ZF3GHU1N9UDozEw8hMGbwWG4xwbGCLa9FPrg7kp%2BXRvbSePDyhq28VqkuvvBKaWTM41zVX4DuB0lsmCuj2XD65u5SNitSO5nD7r%2BKyZUXXYTPn2454gzLaK3%2FD5yG22y1y3%2FlmNHaeYYjP6FFvN7Wmr8bkh%2B4CitscONcV2l0xD6sXdCfjsSLzHHLKCvBnnQ%2BwOkm0dMLk%2FHVZzFmDZDZksHzNTFLXNZDUldysT%2BKyI28EBMaGrw5DcnxiruetlNV2ay2t8RVHbRFbTcgqRzzISd3CArHtCi%2FDTE%2FoQD%2B2mR0DlXJuiqO1vwdRc258RpfIipXA2zY5TZiTnxmnz90q50dvdfwjJiu%2F%2Bz4r55X8%3D)

I haven't created an ERD because we only have two entities one per each service.

Thanks,,,
